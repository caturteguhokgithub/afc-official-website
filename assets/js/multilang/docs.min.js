document.querySelectorAll(".change-language").forEach(function (e) {
  e.addEventListener("click", function () {
    // Remove active class from all language buttons
    document.querySelectorAll(".change-language").forEach(function (e) {
      e.children[0].classList.remove("active");
    });

    // Hide all language content
    document.querySelectorAll(".load").forEach(function (e) {
      e.style.display = "none";
    });

    // Show the selected language content
    document.querySelector("." + e.dataset.action).style.display = "block";

    // Add active class to the selected button
    e.children[0].classList.add("active");

    // Store the selected language in localStorage
    localStorage.setItem("selectedLanguage", e.dataset.action.substr(5));

    // Build the translation instance if needed
    e.dataset.switch && buildInstance(e.dataset.action.substr(5));
  });
});

var buildInstance = function (e) {
  var n = Translate({ lang: e, className: "translate" });
};

// On page load, set the language based on localStorage
window.onload = function () {
  var storedLang = localStorage.getItem("selectedLanguage");
  if (storedLang) {
    // Set the language to the stored value
    buildInstance(storedLang);
    updateActiveLanguageUI(storedLang); // Update UI based on stored language
    changeLanguageImage(storedLang); // Change image based on stored language
  } else {
    // Default language if none is stored
    buildInstance("id");
    updateActiveLanguageUI("id"); // Set default UI
    changeLanguageImage("id"); // Change image to default language
  }
};

function changeLangId() {
  localStorage.setItem("selectedLanguage", "id"); // Store selected language
  updateActiveLanguageUI("id"); // Update UI
  changeLanguageImage("id"); // Change image to Indonesian
}

function changeLangEn() {
  localStorage.setItem("selectedLanguage", "en"); // Store selected language
  updateActiveLanguageUI("en"); // Update UI
  changeLanguageImage("en"); // Change image to English
}

function updateActiveLanguageUI(lang) {
  document.querySelectorAll(".change-language").forEach(function (e) {
    e.children[0].classList.remove("active"); // Remove active class from all
    if (e.id === (lang === "id" ? "id-lang" : "en-lang")) {
      e.children[0].classList.add("active"); // Add active class to selected
    }
  });
}

// Function to change images based on selected language
function changeLanguageImage(lang) {
  const images = document.querySelectorAll(".lang-image"); // Select all images with class 'lang-image'
  images.forEach((img) => {
    if (img.getAttribute("data-lang") === lang) {
      img.style.display = "block"; // Show the image for the selected language
    } else {
      img.style.display = "none"; // Hide the image for the other language
    }
  });
}

function hideAllImages() {
  const images = document.querySelectorAll(".lang-image");
  images.forEach((img) => {
    img.style.display = "none"; // Hide all images by default
  });
}

// Call hideAllImages on page load
window.onload = function () {
  hideAllImages(); // Hide all images initially
  var storedLang = localStorage.getItem("selectedLanguage");
  if (storedLang) {
    // Set the language to the stored value
    buildInstance(storedLang);
    updateActiveLanguageUI(storedLang); // Update UI based on stored language
    changeLanguageImage(storedLang); // Change image based on stored language
  } else {
    // Default language if none is stored
    buildInstance("id");
    updateActiveLanguageUI("id"); // Set default UI
    changeLanguageImage("id"); // Change image to default language
  }
};
